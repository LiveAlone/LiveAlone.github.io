---
title: 垃圾回收算法实践 (1)
tags:
  - GC
  - 垃圾回收
categories:
  - 技术
  - 垃圾回收
  - 算法与实践
date: 2020-09-12 00:25:30
---


#### 简介

最近阅读了一本书籍，中村成洋的《垃圾回收的算法与实践》，个人最先接收到垃圾回收的是JVM 垃圾回收器, 单线程，多线程， CMS, G1, ZGC 等垃圾回收算法，发现垃圾回收算法的思想比JVM 远远早的多，这本书介绍了一些基本的思想，感觉不错。 JVM 垃圾回收也是踩在前人的肩膀上的，想写写这本书的阅读心得。

GC 定义，Garbage Collection 垃圾回收，1. 寻找内存中的垃圾 2. 回收垃圾，重复利用这部分空间。 没有GC的时候， 程序员需要手动管理内存申请释放，比较麻烦。

#### 对象，头，域

- 对象头，标记对象的种类，大小，
- 对象域，存储对象的数据。 基础数据类型，int,double。 指针数据类型，指向地址对象内容。

mutator 程序运行状态，伴随对象的生成，指针的更新。 需要与垃圾的回收保持一个相对的平衡，保证程序的正常运行。
堆， mutator 程序活动中， 对象的存储空间。
活动对象，程序运行通过引用可以触达的对象。非活动对象，程序通过引用无法触达的对象，就是垃圾对象。
chunk 分块，对象的大小不同的，不同对象分配不同大小的块，块废弃以后，需要自动回收。
Root 根对象，引用的起始位置，java 中常量池，运行栈等等。 统一理解为 $Root

#### 评价标准

- 吞吐量
  - 计算方式是 HEAP_SIZ / (GC 回收时间), 相同单位时间里，管理回收区域越大，越好
  - 受到 对象活跃程度，相关的
- 最大停顿时间
  - GC 过程中的 STW 全局停顿时间， 交互型应用比较敏感
- 堆使用效率
  - 对象头标记，用于GC, 每个对象都有，占用堆空间。
  - GC 回收算法，可用的堆内存大小，算法可能限制不能 100% 使用。
- 访问局部性
  - GPU 运行访问内存，三层映射，寄存器 -> 3级CPU缓存 -> 主内存 -> 磁盘内存。 内存读写的 连续性，大大提高数据的读写效率，kafka, rocketMQ 大量数据接收量，基于可连续的写入特性。保证即使落入磁盘，也有类似内存的操作效率。 因此算法垃圾回收，引用对象的局部性， 可以提高程序运行效率方向。
